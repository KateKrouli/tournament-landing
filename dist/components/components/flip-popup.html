<div class="flip-popup" style="display: none;">
    <div class="flip-popup__content">
        <h2>Flip for  a Pick</h2>
        <div class="flip-popup__image" style="position: relative;">
            <img src="images/flip-image.webp" class="flip-popup__img" style="display: block; position: relative; z-index: 2;">
            <div class="flipping">
                <script type="module" src="https://unpkg.com/@splinetool/viewer@1.10.42/build/spline-viewer.js" async></script>
                <spline-viewer loading-anim-type="spinner-small-dark" url="https://prod.spline.design/9qNTa82fDpZlNzSk/scene.splinecode">
                    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAATCAYAAADxlA/3AAAJ+ElEQVR4AQCBAH7/AGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwAAgQB+/wBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAACBAH7/AGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwAAgQB+/wBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AAIEAfv8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAACBAH7/AGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AAIEAfv8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwAAgQB+/wBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAACBAH7/AGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AAIEAfv8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwAAgQB+/wBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAACBAH7/AGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AAIEAfv8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAAGBAH7/AGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AaW1vAGltbwBpbW8AYrIEDg8IZkAAAAAASUVORK5CYII=" alt="Spline preview" style="width: 100%; height: 100%;"/>
                </spline-viewer>
            </div>
        </div>
        <div class="flip-popup__text">
            Let fate pick your side.
        </div>
        <div class="btn--main flip-popup__controls">
            <a href="" class="btn flip-popup__btn">
               Flip
            </a>
        </div>
    </div>
</div>
<div class="flip-overlay" style="display: none;"></div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const btnContainer = document.querySelector('.flip-popup__controls');
  const btn = document.querySelector('.flip-popup__btn');
  const img = document.querySelector('.flip-popup__img');
  const flipping = document.querySelector('.flipping');
  const h2 = document.querySelector('.flip-popup__content h2');
  const text = document.querySelector('.flip-popup__text');
  const popup = document.querySelector('.flip-popup');
  const overlay = document.querySelector('.flip-overlay');

  // Открытие попапа по клику на любой .flip-link
  document.querySelectorAll('.flip-link').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      if (popup) popup.style.display = 'block';
      if (overlay) overlay.style.display = 'block';
      // Сбросить состояние попапа
      if (img) {
        img.style.visibility = 'visible';
        img.style.opacity = '1';
      }
      if (flipping) {
        flipping.style.opacity = '0';
        flipping.style.visibility = 'hidden';
        flipping.style.zIndex = '1';
      }
      if (h2) h2.textContent = 'Flip for  a Pick';
      if (text) text.textContent = 'Let fate pick your side.';
      if (btn) {
        btn.textContent = 'Flip';
        btn.removeAttribute('disabled');
        btn.setAttribute('href', '');
      }
      if (btnContainer) btnContainer.classList.remove('disabled');
    });
  });

  // Закрытие попапа по клику на оверлей
  if (overlay) {
    overlay.addEventListener('click', function() {
      if (popup) popup.style.display = 'none';
      overlay.style.display = 'none';
    });
  }

  if (btn) {
    btn.addEventListener('click', function(e) {
      e.preventDefault();
      if (btn.disabled) return;

      // Скрыть картинку, показать flipping, изменить тексты и заблокировать кнопку
      if (img) img.style.visibility = 'hidden';
      if (img) img.style.opacity = '0';
      if (flipping) {
        flipping.style.opacity = '1';
        flipping.style.visibility = 'visible';
        flipping.style.zIndex = '3';
      }
      if (h2) h2.textContent = 'Flipping...';
      if (text) text.textContent = 'Wait for it...';
      btn.textContent = 'The coin is in the air.';
      btn.setAttribute('disabled', 'disabled');
      btnContainer.classList.add('disabled');

      // Через 3 секунды вернуть всё обратно с результатом
      setTimeout(function() {
        // Рандомно выбрать сторону
        const isFener = Math.random() < 0.5;
        if (img) {
          img.style.visibility = 'visible';
          img.style.opacity = '1';
        }
        if (flipping) {
          flipping.style.opacity = '0';
          flipping.style.visibility = 'hidden';
          flipping.style.zIndex = '1';
        }
        if (h2) h2.textContent = 'Your Side:';
        if (text) {
          text.textContent = isFener
            ? 'Bet on Fenerbahçe now on our website.'
            : 'Bet on Galatasaray now on our website.';
        }
        btn.textContent = 'Bet Now';
        btn.removeAttribute('disabled');
        btn.setAttribute('href', 'https://1xbet.com/tr');
        btnContainer.classList.remove('disabled');
      }, 3000);
    });
  }
});
</script>